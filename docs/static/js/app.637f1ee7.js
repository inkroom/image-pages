(function(){"use strict";var e={333:function(e,t,i){var n=i(311),r=i.n(n),s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view"),e.$store.state.loading?e._e():t("div",{staticStyle:{"text-align":"center",margin:"15px"}},[t("el-link",{attrs:{type:"primary",href:"https://beian.miit.gov.cn/",target:"_blank"}},[e._v("蜀ICP备17000680号")]),e._v(" @copyright 墨盒")],1)],1)},o=[],a=ELEMENT,l=i.n(a),c={name:"App",watch:{"$store.loading"(e,t){e?console.log("开始loading--wacht"):console.log("关闭loading--watch")}}},d=c,h=i(1),u=(0,h.Z)(d,s,o,!1,null,null,null),m=u.exports,g=VueRouter,p=i.n(g),f=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"covers-container"}},[t("el-row",{attrs:{gutter:20}},e._l(e.covers,(function(i,n){return t("el-col",{key:n,attrs:{xs:24,sm:12,md:6,lg:4,xl:3}},[t("el-card",{style:{cursor:e.album?"auto":"pointer"},nativeOn:{click:function(t){return e.push(i.name)}}},[t("InkImg",{staticStyle:{height:"160px","line-height":"160px"},attrs:{src:e.getImgUrl(i),imgStyle:{maxWidth:"100%",verticalAlign:"middle"}}}),t("div",{staticClass:"text-ellipsis name",staticStyle:{padding:"5px"}},[t("span",{attrs:{title:i.name}},[e._v(e._s(i.name))])])],1)],1)})),1)],1)},v=[],_=function(){var e=this,t=e._self._c;return t("div",{staticClass:"img-container"},[t("InkElImage",{style:e.imgStyle,attrs:{src:e._f("cdnSrc")(e.src),"preview-src-list":e.srcList,initialIndex:e.initialIndex,lazy:e.lazy,fit:"contain",referrerpolicy:"no-referrer"}},[t("div",{attrs:{slot:"placeholder"},slot:"placeholder"},[t("i",{staticClass:"el-icon-loading"})]),t("div",{attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])])],1)},w=[],y=function(){var e=this,t=e._self._c;return t("div",{staticClass:"el-image"},[e.loading?e._t("placeholder",(function(){return[t("div",{staticClass:"el-image__placeholder"})]})):e.error?e._t("error",(function(){return[t("div",{staticClass:"el-image__error"},[e._v(e._s(e.t("el.image.error")))])]})):t("img",e._g(e._b({staticClass:"el-image__inner",class:{"el-image__inner--center":e.alignCenter,"el-image__preview":e.preview},style:e.imageStyle,attrs:{src:e.src},on:{click:e.clickHandler}},"img",e.$attrs,!1),e.$listeners)),e.preview?[e.showViewer?t("image-viewer",e._b({attrs:{"z-index":e.zIndex,"initial-index":e.imageIndex,"on-close":e.closeViewer,"url-list":e.previewSrcList}},"image-viewer",e.$attrs,!1)):e._e()]:e._e()],2)},b=[],x=function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"viewer-fade"}},[t("div",{ref:"el-image-viewer__wrapper",staticClass:"el-image-viewer__wrapper",style:{"z-index":e.viewerZIndex},attrs:{tabindex:"-1"}},[t("div",{staticClass:"el-image-viewer__mask",on:{click:function(t){return t.target!==t.currentTarget?null:e.handleMaskClick.apply(null,arguments)}}}),t("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:e.hide}},[t("i",{staticClass:"el-icon-close"})]),e.isSingle?e._e():[t("span",{staticClass:"el-image-viewer__btn el-image-viewer__prev",class:{"is-disabled":!e.infinite&&e.isFirst},on:{click:e.prev}},[t("i",{staticClass:"el-icon-arrow-left"})]),t("span",{staticClass:"el-image-viewer__btn el-image-viewer__next",class:{"is-disabled":!e.infinite&&e.isLast},on:{click:e.next}},[t("i",{staticClass:"el-icon-arrow-right"})])],t("div",{staticClass:"el-image-viewer__btn el-image-viewer__actions"},[t("div",{staticClass:"el-image-viewer__actions__inner"},[t("i",{staticClass:"el-icon-zoom-out",on:{click:function(t){return e.handleActions("zoomOut")}}}),t("i",{staticClass:"el-icon-zoom-in",on:{click:function(t){return e.handleActions("zoomIn")}}}),t("i",{staticClass:"el-image-viewer__actions__divider"}),t("i",{class:e.mode.icon,on:{click:e.toggleMode}}),t("i",{staticClass:"el-image-viewer__actions__divider"}),t("i",{staticClass:"el-icon-refresh-left",on:{click:function(t){return e.handleActions("anticlocelise")}}}),t("i",{staticClass:"el-icon-refresh-right",on:{click:function(t){return e.handleActions("clocelise")}}})])]),t("div",{staticClass:"el-image-viewer__canvas"},e._l(e.urlList,(function(i,n){return n===e.index?t("img",e._b({key:i,ref:"img",refInFor:!0,staticClass:"el-image-viewer__img",style:e.imgStyle,attrs:{src:e.currentImg},on:{load:e.handleImgLoad,error:e.handleImgError,mousedown:e.handleMouseDown}},"img",e.$attrs,!1)):e._e()})),0)],2)])},I=[],$=i(655),k=i(454),L=i(526);const C={CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}},S=(0,k.vU)()?"DOMMouseScroll":"mousewheel";var O={props:{urlList:{type:Array,default:()=>[]},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:()=>{}},onClose:{type:Function,default:()=>{}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0}},data(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!1,mode:C.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}},computed:{isSingle(){return this.urlList.length<=1},isFirst(){return 0===this.index},isLast(){return this.index===this.urlList.length-1},currentImg(){return this.urlList[this.index]},imgStyle(){const{scale:e,deg:t,offsetX:i,offsetY:n,enableTransition:r}=this.transform,s={transform:`scale(${e}) rotate(${t}deg)`,transition:r?"transform .3s":"","margin-left":`${i}px`,"margin-top":`${n}px`};return this.mode===C.CONTAIN&&(s.maxWidth=s.maxHeight="100%"),s},viewerZIndex(){const e=L.q.nextZIndex();return this.zIndex>e?this.zIndex:e}},watch:{index:{handler:function(e){this.reset(),this.onSwitch(e)}},currentImg(e){this.$nextTick((e=>{const t=this.$refs.img[0];t.complete||(this.loading=!0)}))}},methods:{hide(){this.deviceSupportUninstall(),this.onClose()},deviceSupportInstall(){this._keyDownHandler=e=>{e.stopPropagation();const t=e.keyCode;switch(t){case 27:this.hide();break;case 32:this.toggleMode();break;case 37:this.prev();break;case 38:this.handleActions("zoomIn");break;case 39:this.next();break;case 40:this.handleActions("zoomOut");break}},this._mouseWheelHandler=(0,k.TE)((e=>{const t=e.wheelDelta?e.wheelDelta:-e.detail;t>0?this.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):this.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})})),(0,$.on)(document,"keydown",this._keyDownHandler),(0,$.on)(document,S,this._mouseWheelHandler)},deviceSupportUninstall(){(0,$.S1)(document,"keydown",this._keyDownHandler),(0,$.S1)(document,S,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad(e){this.loading=!1},handleImgError(e){this.loading=!1,e.target.alt="加载失败"},handleMouseDown(e){if(this.loading||0!==e.button)return;const{offsetX:t,offsetY:i}=this.transform,n=e.pageX,r=e.pageY;this._dragHandler=(0,k.TE)((e=>{this.transform.offsetX=t+e.pageX-n,this.transform.offsetY=i+e.pageY-r})),(0,$.on)(document,"mousemove",this._dragHandler),(0,$.on)(document,"mouseup",(e=>{(0,$.S1)(document,"mousemove",this._dragHandler)})),e.preventDefault()},handleMaskClick(){this.maskClosable&&this.hide()},reset(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode(){if(this.loading)return;const e=Object.keys(C),t=Object.values(C),i=t.indexOf(this.mode),n=(i+1)%e.length;this.mode=C[e[n]],this.reset()},prev(){if(this.isFirst&&!this.infinite)return;const e=this.urlList.length;this.index=(this.index-1+e)%e},next(){if(this.isLast&&!this.infinite)return;const e=this.urlList.length;this.index=(this.index+1)%e},handleActions(e,t={}){if(this.loading)return;const{zoomRate:i,rotateDeg:n,enableTransition:r}={zoomRate:.2,rotateDeg:90,enableTransition:!0,...t},{transform:s}=this;switch(e){case"zoomOut":s.scale>.2&&(s.scale=parseFloat((s.scale-i).toFixed(3)));break;case"zoomIn":s.scale=parseFloat((s.scale+i).toFixed(3));break;case"clocelise":s.deg+=n;break;case"anticlocelise":s.deg-=n;break}s.enableTransition=r}},mounted(){this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["el-image-viewer__wrapper"].focus()},destroyed(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},z=O,N=(0,h.Z)(z,x,I,!1,null,null,null),A=N.exports,E=i(419),T=i(954),H=i(563),R=i.n(H);const D=()=>void 0!==document.documentElement.style.objectFit,M={NONE:"none",CONTAIN:"contain",COVER:"cover",FILL:"fill",SCALE_DOWN:"scale-down"};let U="";var j={mixins:[E.Z],inheritAttrs:!1,components:{ImageViewer:A},props:{src:String,fit:String,lazy:Boolean,scrollContainer:{},previewSrcList:{type:Array,default:()=>[]},zIndex:{type:Number,default:2e3},initialIndex:Number},data(){return{loading:!0,error:!1,show:!this.lazy,imageWidth:0,imageHeight:0,showViewer:!1}},computed:{imageStyle(){const{fit:e}=this;return!this.$isServer&&e?D()?{"object-fit":e}:this.getImageStyle(e):{}},alignCenter(){return!this.$isServer&&!D()&&this.fit!==M.FILL},preview(){const{previewSrcList:e}=this;return Array.isArray(e)&&e.length>0},imageIndex(){let e=0;const t=this.initialIndex;if(t>=0)return e=t,e;const i=this.previewSrcList.indexOf(this.src);return i>=0?(e=i,e):e}},watch:{src(e){this.show&&this.loadImage()},show(e){e&&this.loadImage()}},mounted(){this.lazy?this.addLazyLoadListener():this.loadImage()},beforeDestroy(){this.lazy&&this.removeLazyLoadListener()},methods:{loadImage(){if(this.$isServer)return;this.loading=!0,this.error=!1;const e=new Image;e.onload=t=>this.handleLoad(t,e),e.onerror=this.handleError.bind(this),Object.keys(this.$attrs).forEach((t=>{const i=this.$attrs[t];e.setAttribute(t,i)})),e.src=this.src},handleLoad(e,t){this.imageWidth=t.width,this.imageHeight=t.height,this.loading=!1,this.error=!1},handleError(e){this.loading=!1,this.error=!0,this.$emit("error",e)},handleLazyLoad(){(0,$.XU)(this.$el,this._scrollContainer)&&(this.show=!0,this.removeLazyLoadListener())},addLazyLoadListener(){if(this.$isServer)return;const{scrollContainer:e}=this;let t=null;t=(0,T.vT)(e)?e:(0,T.HD)(e)?document.querySelector(e):(0,$.JX)(this.$el),t&&(this._scrollContainer=t,this._lazyLoadHandler=R()(200,this.handleLazyLoad),(0,$.on)(t,"scroll",this._lazyLoadHandler),this.handleLazyLoad())},removeLazyLoadListener(){const{_scrollContainer:e,_lazyLoadHandler:t}=this;!this.$isServer&&e&&t&&((0,$.S1)(e,"scroll",t),this._scrollContainer=null,this._lazyLoadHandler=null)},getImageStyle(e){const{imageWidth:t,imageHeight:i}=this,{clientWidth:n,clientHeight:r}=this.$el;if(!t||!i||!n||!r)return{};const s=t/i,o=n/r;if(e===M.SCALE_DOWN){const s=t<n&&i<r;e=s?M.NONE:M.CONTAIN}switch(e){case M.NONE:return{width:"auto",height:"auto"};case M.CONTAIN:return s<o?{width:"auto"}:{height:"auto"};case M.COVER:return s<o?{height:"auto"}:{width:"auto"};default:return{}}},clickHandler(){this.preview&&(U=document.body.style.overflow,document.body.style.overflow="hidden",this.showViewer=!0)},closeViewer(){document.body.style.overflow=U,this.showViewer=!1}}},Z=j,F=(0,h.Z)(Z,y,b,!1,null,null,null),V=F.exports,W={name:"InkImg",components:{InkElImage:V},props:{src:String,imgStyle:Object,lazy:{type:Boolean,default:!1},srcList:{type:Array,default:()=>[]},initialIndex:Number},filters:{cdnSrc(e){return e}}},P=W,B=(0,h.Z)(P,_,w,!1,null,null,null),X=B.exports,Y=i(121),q={components:{InkImg:X},data(){return{limit:{col:6,span:4},covers:[],album:null}},created(){document.title="墨明棋妙",this.getImages()},methods:{push(e){this.$store.commit("loading",!0),console.log("设置loading"),this.$router.push(encodeURIComponent(e))},getImgUrl(e){return e.url?e.url:`${location.protocol}//image.inkroom.cn/raw/${e.name}/${e.cover}`},getImages(){console.log("发送githu");Y.Z.get(`${location.protocol}//image.inkroom.cn/raw/config.json?r=${Math.random()}`).then((e=>{console.log(e.data),e=e.data,this.covers=e})).catch((e=>{console.error(e),this.$alert("相册暂不可用")})).finally((e=>{this.$store.commit("loading",!1)}))}}},J=q,G=(0,h.Z)(J,f,v,!1,null,null,null),K=G.exports,Q=function(){var e=this,t=e._self._c;return e.$store.state.loading?e._e():t("div",{attrs:{id:"covers-container"}},[t("div",[t("span",{staticStyle:{"vertical-align":"bottom","font-size":"20px"}},[e._v("共 "+e._s(e.covers.length)+" 张")]),t("el-link",{staticClass:"el-link el-link--primary is-underline",staticStyle:{"font-size":"20px"},nativeOn:{click:function(t){return e.home.apply(null,arguments)}}},[e._v("首页")]),t("el-link",{staticStyle:{"font-size":"20px"},attrs:{href:e.url.upload,target:"_blank",type:"primary"}},[e._v("上传图片")])],1),t("el-row",{attrs:{gutter:20}},e._l(e.covers,(function(i,n){return t("el-col",{key:n,attrs:{xs:24,sm:12,md:6,lg:4,xl:3}},[t("el-card",{style:{cursor:e.album?"auto":"pointer"}},[t("InkImg",{staticStyle:{height:"160px","line-height":"160px"},attrs:{src:i.download_url,srcList:e.srcList,imgStyle:{maxWidth:"100%",verticalAlign:"middle"},initialIndex:n,lazy:""}}),t("div",{staticClass:"text-ellipsis name",staticStyle:{padding:"5px"}},[t("span",{attrs:{title:i.name}},[e._v(e._s(i.name))])])],1)],1)})),1)],1)},ee=[],te={components:{InkImg:X},data(){return{style:"max-width:260px",limit:{col:6,span:4},url:{upload:`https://github.com/${{NODE_ENV:"production",BASE_URL:"/"}.AUTHOR}/${{NODE_ENV:"production",BASE_URL:"/"}.REPO}/upload/master/${decodeURIComponent(this.$route.params.album)}`},covers:[],title:"墨明棋妙",album:null,ismobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}},watch:{title(e){document.title=this.title+" - "+e}},computed:{srcList(){return this.covers.map((e=>-1!=e.download_url.indexOf("@1e_1c.webp")?e.download_url.replace("@1e_1c.webp",""):`${location.protocol}//image.inkroom.cn/raw/${encodeURI(e.path)}`))}},destroyed(){window.removeEventListener("popstate",this.popstate)},created(){document.title=`${this.title} - ${this.$route.params.album}`,this.getImages()},methods:{home(){this.$store.commit("loading",!0),this.$router.push("/")},getImages(){Y.Z.get(`${location.protocol}//image.inkroom.cn/raw/list/${this.$route.params.album}.list?r=${Math.random()}`).then((e=>{this.covers=e.data.split("\n").filter((e=>!!e&&e.length>1)).map((e=>{var t=e.split("-"),i=`${location.protocol}//image.inkroom.cn/raw/${encodeURI(this.$route.params.album)}/${encodeURI(e)}`;return t.length>1&&(i=JSON.parse(t[t.length-1]).result[0]),{path:`${this.$route.params.album}/${-1==e.indexOf("{")?e:e.substr(0,e.lastIndexOf("{")-1)}`,name:t[0].substr(0,e.lastIndexOf(".")),download_url:i}}))})).catch((e=>(console.log("降级了",e),Y.Z.get(`${location.protocol}//image.inkroom.cn/list/${this.$route.params.album}/list?r=${Math.random()}`).then((e=>{this.covers=e.data.split("\r\n").map((e=>({path:`${this.$route.params.album}/${e}`,name:e.substr(0,e.lastIndexOf(".")),download_url:`${location.protocol}//image.inkroom.cn/raw/${encodeURI(this.$route.params.album)}/${encodeURI(e)}`})))}))))).catch((e=>{this.$alert(` ${this.$route.params.album} 暂不可用`),console.error(e)})).finally((e=>{this.$store.commit("loading",!1)}))},popstate(){return history.pushState(null,null,document.URL),this.dialog.visible=!1,window.removeEventListener("popstate",this.popstate),!1}}},ie=te,ne=(0,h.Z)(ie,Q,ee,!1,null,null,null),re=ne.exports;r().use(p());const se=[{path:"/",name:"/",component:K},{path:"/:album",name:"/album",component:re}],oe=new(p())({mode:"history",base:"/",routes:se});var ae=oe,le=i(629);r().use(l()),r().config.productionTip=!1,r().use(le.ZP);let ce=!1;ce=l().Loading.service({text:"正在努力加载中..."});let de=new le.ZP.Store({state:{loading:!0},getters:{},mutations:{loading(e,t){e.loading=t,t?ce=l().Loading.service({text:"正在努力加载中..."}):(console.log("关闭loading"),ce&&ce.close(),ce=null)}},actions:{},modules:{}});new(r())({router:ae,store:de,render:function(e){return e(m)}}).$mount("#app")},311:function(e){e.exports=Vue}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,i),s.exports}i.m=e,function(){var e=[];i.O=function(t,n,r,s){if(!n){var o=1/0;for(d=0;d<e.length;d++){n=e[d][0],r=e[d][1],s=e[d][2];for(var a=!0,l=0;l<n.length;l++)(!1&s||o>=s)&&Object.keys(i.O).every((function(e){return i.O[e](n[l])}))?n.splice(l--,1):(a=!1,s<o&&(o=s));if(a){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,r,s]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,s,o=n[0],a=n[1],l=n[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(r in a)i.o(a,r)&&(i.m[r]=a[r]);if(l)var d=l(i)}for(t&&t(n);c<o.length;c++)s=o[c],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return i.O(d)},n=self["webpackChunks"]=self["webpackChunks"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=i.O(void 0,[998],(function(){return i(333)}));n=i.O(n)})();